> Выполнил: Литти Тимофей
## 1. Теоретическая справка

Для численного интегрирования функции $f(x)$ на отрезке $[a, b]$ используются следующие методы:
- **Метод трапеций:** кривая заменяется ломаной линией. Ошибка метода пропорциональна $h^2$, где $h$ — шаг сетки.
- **Метод Симпсона:** кривая аппроксимируется параболами. Ошибка пропорциональна $h^4$, что делает этот метод значительно более точным при гладких функциях.
Для оценки точности, когда аналитическое значение неизвестно, используется правило Рунге:
$$E \approx \frac{I_{2n} - I_n}{2^p - 1}$$
где $p$ — порядок точности метода ($p=2$ для трапеций, $p=4$ для Симпсона).

---
## 2. Код

Программа рассчитывает интеграл $\int_0^{\pi} \sin(x) dx$ (аналитическое значение равно 2) и исследует сходимость.

```python
import numpy as np

def f1(x):
    return np.sin(x)

def f2(x):
    return np.exp(-x**2)

def trapezoidal_rule(f, a, b, n):
    x = np.linspace(a, b, n + 1)
    y = f(x)
    h = (b - a) / n
    return h * (0.5 * y[0] + 0.5 * y[-1] + np.sum(y[1:-1]))

def simpson_rule(f, a, b, n):
    if n % 2 != 0: n += 1  # n должно быть четным
    x = np.linspace(a, b, n + 1)
    y = f(x)
    h = (b - a) / n
    return h / 3 * (y[0] + y[-1] + 4 * np.sum(y[1:-1:2]) + 2 * np.sum(y[2:-2:2]))

# Исследование точности для sin(x) от 0 до pi
a, b = 0, np.pi
exact_val = 2.0
intervals = [10, 20, 40, 80]

print(f"{'N':>5} | {'Err Trap':>12} | {'Ratio T':>8} | {'Err Simp':>12} | {'Ratio S':>8}")
print("-" * 60)

prev_err_t = None
prev_err_s = None

for n in intervals:
    res_t = trapezoidal_rule(f1, a, b, n)
    res_s = simpson_rule(f1, a, b, n)
    
    err_t = abs(exact_val - res_t)
    err_s = abs(exact_val - res_s)
    
    ratio_t = prev_err_t / err_t if prev_err_t else 0
    ratio_s = prev_err_s / err_s if prev_err_s else 0
    
    print(f"{n:5d} | {err_t:12.8e} | {ratio_t:8.2f} | {err_s:12.8e} | {ratio_s:8.2f}")
    
    prev_err_t = err_t
    prev_err_s = err_s
```

---
### Вывод (stdout)
```stdout
    N |     Err Trap |  Ratio T |     Err Simp |  Ratio S
------------------------------------------------------------
   10 | 1.64764625e-02 |     0.00 | 1.09517315e-04 |     0.00
   20 | 4.11402729e-03 |     4.00 | 6.78444180e-06 |    16.14
   40 | 1.02818950e-03 |     4.00 | 4.23093183e-07 |    16.04
   80 | 2.57027554e-04 |     4.00 | 2.64287592e-08 |    16.01
```
## 3. Ответы на вопросы

### Анализ отношения ошибок
При увеличении числа интервалов в 2 раза ($n \to 2n$):
- В **методе трапеций** ошибка уменьшается примерно в **4 раза** ($2^2$), что подтверждает второй порядок точности.
- В **методе Симпсона** ошибка уменьшается примерно в **16 раз** ($2^4$), что подтверждает четвертый порядок точности.
### Интеграл $\int_0^5 \exp(-x^2) dx$ и оценка точности
Для интеграла функции Гаусса, который не берется в элементарных функциях:
1. **Как оценить точность?** Мы используем внутреннюю проверку: вычисляем интеграл для $n$ и $2n$ шагов.
2. Если разность результатов $|I_{2n} - I_n|$ становится меньше заданной погрешности $\epsilon$, расчет можно считать завершенным
3. Для метода Симпсона истинная ошибка будет примерно в 15 раз меньше, чем эта разность (согласно правилу Рунге).
### Вывод

Метод Симпсона значительно эффективнее для гладких функций, так как требует гораздо меньше вычислительных узлов для достижения той же точности, что и метод трапеций.